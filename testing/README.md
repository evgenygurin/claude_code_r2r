# R2R API Testing Framework

–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è R2R API v3 —Å 100+ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü—Ä–æ–µ–∫—Ç–∞

```
testing/
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îî‚îÄ‚îÄ api_config.json          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ test_documents.py        # –¢–µ—Å—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (40+ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ test_search_rag.py       # –¢–µ—Å—Ç—ã –ø–æ–∏—Å–∫–∞ –∏ RAG (32+ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
‚îÇ   ‚îî‚îÄ‚îÄ test_collections_auth.py # –¢–µ—Å—Ç—ã –∫–æ–ª–ª–µ–∫—Ü–∏–π –∏ auth (30+ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ api_client.py            # –ë–∞–∑–æ–≤—ã–π API –∫–ª–∏–µ–Ω—Ç
‚îú‚îÄ‚îÄ reports/                     # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ test_data/                   # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ run_all_tests.py            # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
‚îî‚îÄ‚îÄ README.md                    # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –°—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install requests
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `configs/api_config.json`:

```json
{
  "api_base_url": "http://136.119.36.216:7272",
  "api_version": "v3",
  "timeout": 30,
  "retry_attempts": 3
}
```

### –ó–∞–ø—É—Å–∫ –í—Å–µ—Ö –¢–µ—Å—Ç–æ–≤

```bash
cd testing
python run_all_tests.py
```

### –ó–∞–ø—É—Å–∫ –û—Ç–¥–µ–ª—å–Ω—ã—Ö –¢–µ—Å—Ç–æ–≤—ã—Ö –ù–∞–±–æ—Ä–æ–≤

```bash
# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
python tests/test_documents.py

# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã –ø–æ–∏—Å–∫–∞ –∏ RAG
python tests/test_search_rag.py

# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã –∫–æ–ª–ª–µ–∫—Ü–∏–π –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
python tests/test_collections_auth.py
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –æ—Ç—á–µ—Ç—ã:

- **JSON –æ—Ç—á–µ—Ç:** `reports/r2r_api_test_results_TIMESTAMP.json`
- **HTML –æ—Ç—á–µ—Ç:** `reports/r2r_api_test_report_TIMESTAMP.html`

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ –°—Ü–µ–Ω–∞—Ä–∏–∏

### Documents API (40+ —Ç–µ—Å—Ç–æ–≤)

- –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (12 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
- –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (12 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (10 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
- –£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (10 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)

### Search & RAG API (32+ —Ç–µ—Å—Ç–æ–≤)

- –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ (15 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
- RAG –≥–µ–Ω–µ—Ä–∞—Ü–∏—è (17 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)

### Collections & Auth API (30+ —Ç–µ—Å—Ç–æ–≤)

- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (12 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏ (18 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)

## üíª –ü—Ä–∏–º–µ—Ä—ã –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API Client

```python
from utils.api_client import R2RAPIClient

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
client = R2RAPIClient()

# Health check
health = client.health_check()
print(health)

# –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç
result = client.create_document(
    file_path="test.txt",
    metadata={"title": "Test Document"},
    ingestion_mode="fast"
)

# –ü–æ–∏—Å–∫
search_result = client.search(
    query="artificial intelligence",
    limit=10
)

# RAG –∑–∞–ø—Ä–æ—Å
rag_result = client.rag_query(
    query="What is machine learning?",
    rag_generation_config={
        "model": "openai/gpt-4o-mini",
        "temperature": 0.7
    }
)
```

### –°–æ–∑–¥–∞–Ω–∏–µ –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¢–µ—Å—Ç–æ–≤

```python
from utils.api_client import R2RAPIClient

client = R2RAPIClient()

# –í–∞—à —Ç–µ—Å—Ç
result = client.search(query="test query")
client.log_test_result(
    test_name="My Custom Test",
    scenario="Test scenario description",
    result=result,
    expected_status=200,
    description="Detailed description"
)

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
client.save_test_results("my_test_results.json")
```

## üìà –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

HTML –æ—Ç—á–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç:

- –û–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (–≤—Å–µ–≥–æ/–ø—Ä–æ–π–¥–µ–Ω–æ/–ø—Ä–æ–≤–∞–ª–µ–Ω–æ)
- Success rate –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞
- –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—é –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Ç–µ—Å—Ç–æ–≤
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º —Ç–µ—Å—Ç–æ–≤–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¢–∞–π–º–∞—É—Ç–æ–≤

–í `configs/api_config.json`:

```json
{
  "timeout": 60,
  "retry_attempts": 5
}
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ù–æ–≤—ã—Ö –≠–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

–í `configs/api_config.json`:

```json
{
  "endpoints": {
    "my_new_endpoint": "/v3/my/endpoint/{id}"
  }
}
```

–í `utils/api_client.py`:

```python
def my_new_method(self, id: str):
    endpoint = self.endpoints["my_new_endpoint"].format(id=id)
    return self._make_request("GET", endpoint)
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–§—Ä–µ–π–º–≤–æ—Ä–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç:

- URL –∑–∞–ø—Ä–æ—Å–∞
- HTTP –º–µ—Ç–æ–¥
- –°—Ç–∞—Ç—É—Å –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

## üêõ –†–µ—à–µ–Ω–∏–µ –ü—Ä–æ–±–ª–µ–º

### "Access denied" –æ—à–∏–±–∫–∞

API –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã. –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API: `curl http://136.119.36.216:7272/v3/health`
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ VPN –∏–ª–∏ –ø—Ä–æ–∫—Å–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ IP –≤ whitelist

### –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç —Å —Ç–∞–π–º–∞—É—Ç–æ–º

–£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç –≤ –∫–æ–Ω—Ñ–∏–≥–µ:

```json
{
  "timeout": 120
}
```

### –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `api_config.json`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é API

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–º. –æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ç—á–µ—Ç: `../R2R_API_TESTING_REPORT.md`

## ü§ù –í–∫–ª–∞–¥

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤:

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª –≤ `tests/`
2. –ù–∞—Å–ª–µ–¥—É–π—Ç–µ—Å—å –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
3. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã
4. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –≤ `run_all_tests.py`

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Å–æ–∑–¥–∞–Ω –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è R2R API.

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ R2R API: https://github.com/SciPhi-AI/R2R
